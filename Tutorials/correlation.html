<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Correlation and partial correlation</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}
</style>



</head>

<body>
<h1>Correlation and partial correlation</h1>

<h2>Correlation</h2>

<p>The correlation coefficients speaks to degree to which two variables can be summarized by a straight line.</p>

<pre><code class="r">set.seed(1)
n &lt;- 1000
x1 &lt;- rnorm(n, -1, 10)
x2 &lt;- rnorm(n, 3, 2)
y &lt;- 5 * x1 + x2 + rnorm(n, 1, 2)
</code></pre>

<p>To obtain the correlation of two variables we simply list them consecutively:</p>

<pre><code class="r">cor(x1, x2)
</code></pre>

<pre><code>## [1] 0.006401
</code></pre>

<p>If we want to test the significance of the correlation, we need to use the <code>cor.test</code> function:</p>

<pre><code class="r">cor.test(x1, x2)
</code></pre>

<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x1 and x2
## t = 0.2022, df = 998, p-value = 0.8398
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.05561  0.06837
## sample estimates:
##      cor 
## 0.006401
</code></pre>

<p>To obtain a correlation matrix, we have to supply an input matrix:</p>

<pre><code class="r">cor(cbind(x1, x2, y))
</code></pre>

<pre><code>##          x1       x2       y
## x1 1.000000 0.006401 0.99838
## x2 0.006401 1.000000 0.04731
## y  0.998376 0.047312 1.00000
</code></pre>

<h2>Correlations of non-linear relationships</h2>

<pre><code class="r">a &lt;- rnorm(n)
b &lt;- a^2 + rnorm(n)
</code></pre>

<p>If we plot the relationship of <code>b</code> on <code>a</code>, we see a strong (non-linear) relationship:</p>

<pre><code class="r">plot(b ~ a)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<p>Yet the correlation between the two variables is low:</p>

<pre><code class="r">cor(a, b)
</code></pre>

<pre><code>## [1] -0.01712
</code></pre>

<pre><code class="r">cor.test(a, b)
</code></pre>

<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  a and b
## t = -0.541, df = 998, p-value = 0.5886
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.07903  0.04492
## sample estimates:
##      cor 
## -0.01712
</code></pre>

<p>If we can identify the functional form of the relationship, however, we can figure out what the relationship really is.
Clearly a linear relationship is inappropriate:</p>

<pre><code class="r">plot(b ~ a, col = &quot;gray&quot;)
curve((x), col = &quot;red&quot;, add = TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<p>But what about <code>y ~ x^2</code> (of course, we know this is correct):</p>

<pre><code class="r">plot(b ~ a, col = &quot;gray&quot;)
curve((x^2), col = &quot;blue&quot;, add = TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-9"/> </p>

<p>The correlation between <code>b</code> and <code>a</code><sup>2</sup> is thus much higher:</p>

<pre><code class="r">cor(a^2, b)
</code></pre>

<pre><code>## [1] 0.843
</code></pre>

<p>We can see this visually by plotting <code>b</code> against the transformed <code>a</code> variable:</p>

<pre><code class="r">plot(b ~ I(a^2), col = &quot;gray&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAeFBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZjlltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1Zjm124+1/v2+vr7ajzna/v39tWX924/9/rX9/tr9/v2RZOdPAAAAKHRSTlP///////////////////////////////////////////////////8AvqouGAAAAAlwSFlzAAALEgAACxIB0t1+/AAAEr5JREFUeJztnYt627gRRlebJuk2Gydt7W67cWs6toz3f8NaEgEMQPAOYkD+/9kvm4gSIVkHMwOAF/9iCCS/aH8AogPFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYOyRvyJ1MyG4lfsS7aG4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXgQmqYJHlM8Bk37x0HxGFA8KBSPCms8uULxoFA8KBQPCsWDQvGgUDwE8WSO4g9DV6180kTLNxR/FBJqh5+l+GNA8aAMi2eNPy6DNT4BxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KKvFv36+3gT7w9Pcpokqa8W/Pdxf/375+HNm00SVteLP35+Cv6c3TVRhxIOyusaf71jj9whH9aBsIH7ir7shqjDiQaF4UFZP5+7avN4d3VF8zayO+LeHr8uaJqqsT/Xnbz8WNU1UYY0HheJBoXhQKB4UigeF4kGh+EqYe9eqtVB8HYzcpy4/FF8HFA8KxaPCGk/GyNJHKH53pKrC/L5A8bsjIX7BCIHidwfFo9LN6xSPCms8mQjFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8VWz3aWUFF8zG148TfE1Q/GgUHyVFLiXAWt8hRS/e0lWKH4xFL+s6d1D8cua3j9rCnDpex11oHgV9LMFxatA8aBQPCqs8UQHigeF4kGheFAoHhSK3x15JgQUvzcyLQFQ/N6geEVctp2edpsrOd7bULwW7rufLqG5qM+zTMsar4au+DxQ/AJmib8FKMUfghk13vaNbDU+ExS/MfoHYNNQ/MYMiFfNABQ/k9m2enfQzQUUP4+Mtih+T0ywNTUnUPyeGLc14RVtz2CN3xOjtkbF1zHOp/jcUDyo+NGcQPGoVLGCR/GbUYXfXih+K7oZvaqeQPFp1kvqiK+jtlsoPkmzXj3F75Gm/S/95LQuEb+M4nfAkPjFAlnjlZkioOk/X6auyF0KoPhp4vrPl6H4dU2rkRLXsTxkt6qUvRSKT286RlgPACg+EbEUH3NI8V1SSeAI+XwAir9ydM1dwMVfhHcHdgi9AFt8YxJp/rbh6PYp/hr03Y2Gg7uNmq6Bpr2ijeJjDi2+vZwtWeMpfrOm1WlruUkbTtf441R+bPHJgB/e5Sh5AEt8IHnwmHvP/obiVzetQORt4NDrtAb2DLL4BR6ruPopC9DiF/s7QORDic8WqBS/ouktmCl22ssTr2rSm/fEocTPDMSJ52ClXtXsfmkPWvykWXxPoxS/tOkNmCfDrtKP7EHxSc7fn8z57nT6+HNu01swqe66KdnEhN3TKHiNfxd/cW9ef5/bdF5m3E24/ZM+GF/sY2iTQfzrl5+3yLdNWtZ/usnMEOhfOnelvqc90cKO8v9q8Xe//vnHJeK/dHJ9beJbQ5nlBM0BiTfm7eH0ybx8eOo8UZl4n+KXBPm062qgxC9tOi+Lp2UTm+/dOXwGp8Yvb7o0biyXcLPmHmb7cR2AI15M3mJTt21DBneUwydyMPHLMv4tESSemNPwkpcqcizxc8Z48bZcQb2T5AAnvrfGU7zkgOLTO2ZZy1n3GcpyLPFL5WWVxRq/Yt/C7CRKc0LxFyg+BkD87STrpel5H3k9wdHEzz54vi7Y95sqDia+R8TQimv/U8vfbwfULX7+7/oyFD+NqsXP/1rni185hT94jX97OJ1On/I2PYEF8bToBLn4fXZrcwaTxL89fH3//3PihMoVTU+gL35ze4neJ7mcf7S+MEn87YQ6cVpdjqankPy689fVcfH7reV9TEv1j9eIn5nrtxrVL5MwGLLhXJ7ib+Ivp81fSZxXt6LpxSySMLqTvFh+yj1P9579qx7V95DwsvqMu7HbY0zrCztij+IlLlBH1l2HZvK3JqbdF8W/B8UvbDoL12/fmRsyMXJ+dDNtQi/eg+IXNj2RKTNwH64LTMh0MT4SEC9gjV/W9DTSKuIB+DRr4+8wS/y+2Zt4r7i9IEpc8TrvTNgmEbnjXvcd5oKdiRcFeWnOvZ1Y2TOUO4zXUWoXH6lIip9/c8oF9zY8GtWLDwkmbosmVhR/o2rxjSzFblP0j/E5erjl+idoGCe/C2oWH2f06FknT06u7Y3IBy6U69ylPPGinpceiN2Kl08GacCFc3KG13fTup63OG452J94H+adJxsvvUd8MgUktg0/cQRqEN+/mtqt8c7GJPFx0+lDcH3vT/GbNO2Y9/3aGp4c+YU1PtFp/GB+yruyxm/RtGPebKxJJwL7rA1zuaIn32nobAsodic+rbSvzY74ZZP/A1KD+OkZ1Ua0SUgLWumZy8nXjLzrkdP8BX3x4Sx8+KWNrOHRuM1IzW3GX+7u8AmhCvHdhZjel7qJe/zi6PGUejDprY5KDeLlWRSTxKde7B/btDDW2sinoviNmnYEZ1GM1d1gJTbI+PYfdhYf5f7hE3kS63ms8Rs17ZEZfOSVoiaEKzWiEbsxGMmZoT51+PBOUIP42dEljs606zSipMve4PcwSbXB4OLoMR5ShfgJJMK38Ys5gWxx2G7kXOiwbCRfcliqFR/GX1jVjbHDQTe/89GbPk6fDOegxlC8REe8lduJWJvbnXhjM70I9+mLc8ELKF5SUny8jB4cSjNCvJwHtI/ckN6O58VOU96y8+DwlBWf/m7DOZpXKg6l+XmcD2mfFuRZVEI8mMp5FBXfijKhEh/NUny7CBNM32LN3dqMNjZfTmnxsj77raF4l8p9Am8Sr0qOxul9IvWId9Mzt92vyfnS3paBRu5A2QsoXuO74vtmYH4Xn/cbad8+niGefcRSNuL9NHzqaW4u2KXhcEAf72LfakrzuCiI792h2yl8MjfCWpg2kjJlRehsJqas+GZYvB+7i9m7WJ2J5nSuh6SaTAz73OZlP83RKCh+rB6nxPsCH0b9mL2UeLnQQ8qJ96O0HtyYX0zr7HKM6BTTwrZb/RntAcXEi8G5fRzv4JfiZBaXstMjw97OFDxB8QHlxPuQt/LaIXrifIlOVm8SIRzslCz0yQN85ErhiLeFV0zRjBE9ICjlvrzbJ00nvOUO8VMmNM36LlEVH0y65HjM/luu1viS74p9d8DHEJ+KlnjvtPG+RYw3wapcsFTb2JV847OE33loFZB4FAZ3Yp3db7dOjQx7Id7nBXe41sW/XBE0QjZz+wBlxRuR2tuNQmQTqnYrdME6jU0Gtjf4MZ/cNYZ9IKa8+CAdt8+4ai6Lu9/n+irjBvhhV5Dik+ndv/GKH+ZwKIg3sRuXr+3LXBX3FT8a/YtW3RwgKPhB63JtiNzQWcBxcmy0B08FXSBY0PPJIG5bJvvQPcUnKbiA44drbsIuY1wkai/cjfF8wu7L2fbwfOzYNUjxkqIRLySH0e8TfNAXbAJ3fcW92jYZvYNJiI8Gh+RGKfHWnR3IyxhupFufrgPtVrjvAt2BnBwPUvII5cSHU/kE4jU+pYvdOou3JpjFGdOXCkiCisRHsR3NAN1sLZi2iWWAIdgTOhRN9V3DMsqDGZnoIG6OL2O+bdN0xKccM/d3KT6d64gPDftSbtO96x9GBLq3G4lPOqb4LqUHd92/Gjva6yR7MZ7zFb8zNbMFoX1kKH4SuqneBXQ8gg87RiMnZMOLMWnHTSL/g1NafNwFxNpdtEIbdw4R7mnxvgkyTlnxPQN7J9sEf1vXbgho/HGc/hEcvU9CI9UnQtsYKd4P4ttd/XqO6c3bFD+LwuJTtb67mmtkBQiG+KK5+O0ofhblI35oTu97gD02Ey7QtZt6xu5h3yCD1DCqT+eAYGVWbGBkZ6G4+G5iD2RH20zQZSg+Hzo1vrMsm+4ERpR6d3BGTOnJcupL9cGQ7rqrWLy1Gyl+LSrTubFu4CP+uqub3bv0zlS/Gq2IDwfvCelCfBOM8I2h+Ayop/qB6DdNsK+h+IwUX6vvTevBlmA9XiQI0dyKT0YqiPjQe2i5ETu7s25JFpTFG+NPuzHSergI177OMMFnQzvi/VPucLt4KtrdUHw2FNbqY/HGRbcL7MQB927ZnwKLQx/aEe96gp+xRQEvO4VY0+l0jJRi5ohelOfxTrJL+p3xu/xjn+gKTSum+F6UxKfmd25RvnO6tF2edx4pfjU64sPhe3iupYkSfZsNrg+Mj/zuECClOFkAiNGs8V6+Cf4XiQ/Ou7n9SUqm4nlopfrwgRu6uaQfDvRFK51tZBEVjOo7HcGN9dodTdxQ33NkOooRL06wiE+1adzGmEZUeEb+CqqIeCczzP6pOi6fofgVqIkPXJtwoO/6Q4hd2KP4DFQR8b4jBBEf49dwZi7cki5q8/j0Wl73/BvZhrE1fsWnIjdWi3/9fLrw4Wm46dGIb+SRup6hHZXnY634t4f7698vH38ONt2f2cWQrTXOqC7AWvHn70/B35cmLfJ1Y8HuwtyG/rwfgx1lLvoRLx6Jpfl5Hjm+n83qGn++y1bjg9w/C4qfjfp0Ln7WLFFI8bPROyzrV+ri5Rszv2bPzhHwqEZ8e5ZF0wSjfMMILoCKeHkA3sSrOQvH9WQe2ufVRx3BSWfu3hhN8cF1sOJcLHcYjmyHesQbuWrjtjDXb43SBRXBmdSxdNcfyHaoz+MDzf01vmlY97OiL15cDSlzftgWz7HMTRXi2/PuGlveu0dlKT43+uJtcDvhTWJoR/G50b2gwlfuIMUnFLPGZ0Yx4oOl+jC/U/HmqJ5l64p7eBE0KYCeeP+E4by9PMoRb6LqTkqhdwmVoW1NSt/EODiBOjgSw15QFN1boRhR601U5dkRNkX3DJwB8WE6ILnR+UUF3cF9fFwm7BUkOxq/abL9t1unc6U/qPgUvymqZ+DcnjGpIzNcoN0YvZMt3bqdSR6So/dtURvVu4Nw/lQrqi6I4g0ObYyLbkCKoXHOnfEHZzhj00Ih4t0Ghrki5adz7WNa10XlFw4ankeljsYvI+q9Hy0ph+Zty1e0TdaicyUNg10dnZU7ildH644YK9olOSg+qudErg5KiTdCPDN9BZQTb0R5p3h1iol3x2AbZvoaKCfeJH7VEFGjpHh3jIbi9SmY6v0BOYrXp6h4eZsrokvh6RwX6Wuh3AIOT72oioLio/Pk2QdUURPP0b0uRWt88NhQvCaFV+7EQ0PxmhRcq+dl0DWhJ56oUlo847wSyh+dY9xXQcGDNBcovhYoHpTC4lnja6G0eFIJFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg6J2CRXRhVfSgELxoFA8KKzxoHBUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBsKZ7UzHbi435QY1P8UD1QvEJTNXwoildoqoYPRfEKTdXwoSheoakaPhTFKzRVw4eieIWmavhQGcWTPUHxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aDkEn++O338maep18+n032epszbQ6aW3h5Ov/7I0tL7j/fhKU9Lvz0t/+Izib98wc+fsjR1/vbDvP41z5dsnnN1ocd785KlZ19+vOcsLb1cOtDiLz6T+PP3p1sHXM/L5cd4zOPr9W9/z9PQ5efLw+uXn3lae/z1P+9f+OIvPpP464/zLVOYmlxNvf3rz0yp/vXLvzOl+nwRfxW++IvPJP6SBvOJf3v4mqWd56+5avzr5/vrd5yBfKOhi/jFX3yNEX++y+P9/UNlE5/t57sMX17yjO5qiPiMNf4aXVl4vp5enqUTnf+RS3zG3PhaQY2/JOdMo/ps3i9km8495kr1mSN+8Rdf3zz+FqfZpt+ZGnr/+TLNvl9O2VYEKpjHk71B8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCrL468mKz1+Dh7crNjNdO1Ez6OKF4v/+895dsfmc55KOikEXf7k68xbl5+//+91dsZnvIslaARd/EXyN8t+eXj69/XG1fb3OJdPluvUCLt5m+vcO8K768ZLgb1dsHj7Xg4u/3ezg8eQvk2mv2KT4A9NG/Pnu3l93aK/co/gD09b46+C+vfeKu2KTNf7A2FH98+n0l/aWKfaKTY7qj07PUs3hMz28+LRirtyRo0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPyv8B1jBqe//XU4UAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-11"/> </p>

<p>If we now overlay a linear relationship, we see how well the transformed data are represented by a line:</p>

<pre><code class="r">plot(b ~ I(a^2), col = &quot;gray&quot;)
curve((x), col = &quot;blue&quot;, add = TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/> </p>

<p>Now let&#39;s see this side-by-side to see how the transform works:</p>

<pre><code class="r">layout(matrix(1:2, nrow = 1))
plot(b ~ a, col = &quot;gray&quot;)
curve((x^2), col = &quot;blue&quot;, add = TRUE)
plot(b ~ I(a^2), col = &quot;gray&quot;)
curve((x), col = &quot;blue&quot;, add = TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/> </p>

<h2>Partial correlations</h2>

<p>An approach that is sometimes used to examine the effects of variables involves &ldquo;partial correlations.&rdquo;
A partial correlation measures the strength of the linear relationship between two variables, controlling for the influence of one or more covariates.
For example, the correlation of  <code>y</code> and <code>z</code> is:</p>

<pre><code class="r">z &lt;- x1 + rnorm(n, 0, 2)
cor(y, z)
</code></pre>

<pre><code>## [1] 0.9813
</code></pre>

<p>This correlation might be inflated or deflated to do the common antecedent variable <code>x1</code> in both <code>y</code> and <code>z</code>.
Thus we may want to remove the variation due to <code>x1</code> from both <code>y</code> and <code>z</code> via linear regression:</p>

<pre><code class="r">part1 &lt;- lm(y ~ x1)
part2 &lt;- lm(z ~ x1)
</code></pre>

<p>The correlation of the residuals of those two models is thus the partial correlation:</p>

<pre><code class="r">cor(part1$residual, part2$residual)
</code></pre>

<pre><code>## [1] 0.03828
</code></pre>

<p>As we can see, the correlation between these variables is actually much lower once we account for the variation attributable to <code>x1</code>.</p>

</body>

</html>
